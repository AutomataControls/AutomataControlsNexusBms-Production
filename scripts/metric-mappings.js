/**
 * Metric mappings for the monitoring service
 * Generated on 2025-04-10T14:09:35.634Z
 * 
 * This file contains mappings for 214 unique metrics
 * categorized into 14 types.
 */

// Metric mappings by name
const metricMappings = {
  "Active Switch State": [
    "Active Switch State",
    "active switch state",
    "Active_Switch_State"
  ],
  "Cooling Differential": [
    "Cooling Differential",
    "cooling differential",
    "Cooling_Differential"
  ],
  "Cooling Enabled": [
    "Cooling Enabled",
    "cooling enabled",
    "Cooling_Enabled"
  ],
  "DX Enabled": [
    "DX Enabled",
    "dx enabled",
    "DX_Enabled"
  ],
  "Discharge Air": [
    "Discharge Air",
    "discharge air",
    "Discharge_Air"
  ],
  "Fan Status": [
    "Fan Status",
    "fan status",
    "Fan_Status"
  ],
  "HVAC State": [
    "HVAC State",
    "hvac state",
    "HVAC_State"
  ],
  "Heating Actuator": [
    "Heating Actuator",
    "heating actuator",
    "Heating_Actuator"
  ],
  "Last Enable Time": [
    "Last Enable Time",
    "last enable time",
    "Last_Enable_Time"
  ],
  "Last Stage 1 Time": [
    "Last Stage 1 Time",
    "last stage 1 time",
    "Last_Stage_1_Time"
  ],
  "Last Stage 2 Time": [
    "Last Stage 2 Time",
    "last stage 2 time",
    "Last_Stage_2_Time"
  ],
  "Mixed Air": [
    "Mixed Air",
    "mixed air",
    "Mixed_Air"
  ],
  "Occupancy Set For Day": [
    "Occupancy Set For Day",
    "occupancy set for day",
    "Occupancy_Set_For_Day"
  ],
  "Outdoor Air Actuator": [
    "Outdoor Air Actuator",
    "outdoor air actuator",
    "Outdoor_Air_Actuator"
  ],
  "Outdoor Air Temperature": [
    "Outdoor Air Temperature",
    "outdoor air temperature",
    "Outdoor_Air_Temperature",
    "Temperature",
    "temperature",
    "Outside Air Temperature",
    "OutdoorAirTemperature",
    "OAT"
  ],
  "Outdoor Humidity": [
    "Outdoor Humidity",
    "outdoor humidity",
    "Outdoor_Humidity",
    "Humidity",
    "humidity",
    "Outside Air Humidity",
    "Outdoor Air Humidity",
    "RH",
    "Relative Humidity",
    "Outside Humidity",
    "OAH"
  ],
  "Outdoor Wind Speed": [
    "Outdoor Wind Speed",
    "outdoor wind speed",
    "Outdoor_Wind_Speed"
  ],
  "Return Air": [
    "Return Air",
    "return air",
    "Return_Air"
  ],
  "Return Air Actuator": [
    "Return Air Actuator",
    "return air actuator",
    "Return_Air_Actuator"
  ],
  "Stage 1 Enabled": [
    "Stage 1 Enabled",
    "stage 1 enabled",
    "Stage_1_Enabled"
  ],
  "Stage 2 Enabled": [
    "Stage 2 Enabled",
    "stage 2 enabled",
    "Stage_2_Enabled"
  ],
  "Target Temperature": [
    "Target Temperature",
    "target temperature",
    "Target_Temperature",
    "Temperature",
    "temperature"
  ],
  "VFD Enabled": [
    "VFD Enabled",
    "vfd enabled",
    "VFD_Enabled"
  ],
  "VFD Speed": [
    "VFD Speed",
    "vfd speed",
    "VFD_Speed"
  ],
  "DX Enable": [
    "DX Enable",
    "dx enable",
    "DX_Enable"
  ],
  "Freeze Stat": [
    "Freeze Stat",
    "freeze stat",
    "Freeze_Stat"
  ],
  "Mixed Air Temperature": [
    "Mixed Air Temperature",
    "mixed air temperature",
    "Mixed_Air_Temperature",
    "Temperature",
    "temperature",
    "MAT"
  ],
  "North Upstairs": [
    "North Upstairs",
    "north upstairs",
    "North_Upstairs"
  ],
  "Setpoint Differential": [
    "Setpoint Differential",
    "setpoint differential",
    "Setpoint_Differential"
  ],
  "Thermostat Ambient Temperature": [
    "Thermostat Ambient Temperature",
    "thermostat ambient temperature",
    "Thermostat_Ambient_Temperature",
    "Temperature",
    "temperature"
  ],
  "Thermostat Away": [
    "Thermostat Away",
    "thermostat away",
    "Thermostat_Away"
  ],
  "Thermostat Mode": [
    "Thermostat Mode",
    "thermostat mode",
    "Thermostat_Mode"
  ],
  "Thermostat Switch State": [
    "Thermostat Switch State",
    "thermostat switch state",
    "Thermostat_Switch_State"
  ],
  "Thermostat Target Temperature": [
    "Thermostat Target Temperature",
    "thermostat target temperature",
    "Thermostat_Target_Temperature",
    "Temperature",
    "temperature"
  ],
  "Alarm Status": [
    "Alarm Status",
    "alarm status",
    "Alarm_Status"
  ],
  "Heating Differential": [
    "Heating Differential",
    "heating differential",
    "Heating_Differential"
  ],
  "South Office": [
    "South Office",
    "south office",
    "South_Office"
  ],
  "Supply": [
    "Supply",
    "supply"
  ],
  "Boiler Loop Temperature": [
    "Boiler Loop Temperature",
    "boiler loop temperature",
    "Boiler_Loop_Temperature",
    "Temperature",
    "temperature"
  ],
  "Differential Pressure": [
    "Differential Pressure",
    "differential pressure",
    "Differential_Pressure",
    "Pressure",
    "pressure",
    "Static Pressure",
    "SP"
  ],
  "H2O Return": [
    "H2O Return",
    "h2o return",
    "H2O_Return"
  ],
  "H2O Supply": [
    "H2O Supply",
    "h2o supply",
    "H2O_Supply"
  ],
  "HW Pump 1 Status": [
    "HW Pump 1 Status",
    "hw pump 1 status",
    "HW_Pump_1_Status"
  ],
  "HW Pump 2 Status": [
    "HW Pump 2 Status",
    "hw pump 2 status",
    "HW_Pump_2_Status"
  ],
  "Last Enabled Pump": [
    "Last Enabled Pump",
    "last enabled pump",
    "Last_Enabled_Pump"
  ],
  "Building Pressure": [
    "Building Pressure",
    "building pressure",
    "Building_Pressure",
    "Pressure",
    "pressure",
    "Static Pressure",
    "SP"
  ],
  "Exhaust Fan Amps": [
    "Exhaust Fan Amps",
    "exhaust fan amps",
    "Exhaust_Fan_Amps"
  ],
  "Exhaust Fan Status": [
    "Exhaust Fan Status",
    "exhaust fan status",
    "Exhaust_Fan_Status"
  ],
  "Exhaust VFD Speed": [
    "Exhaust VFD Speed",
    "exhaust vfd speed",
    "Exhaust_VFD_Speed"
  ],
  "Freeze Status": [
    "Freeze Status",
    "freeze status",
    "Freeze_Status"
  ],
  "HOA Mode": [
    "HOA Mode",
    "hoa mode",
    "HOA_Mode"
  ],
  "Last Cooling State": [
    "Last Cooling State",
    "last cooling state",
    "Last_Cooling_State"
  ],
  "Last Heating State": [
    "Last Heating State",
    "last heating state",
    "Last_Heating_State"
  ],
  "OA Actuator": [
    "OA Actuator",
    "oa actuator",
    "OA_Actuator"
  ],
  "Occupied Scheduled": [
    "Occupied Scheduled",
    "occupied scheduled",
    "Occupied_Scheduled"
  ],
  "Outdoor Temperature": [
    "Outdoor Temperature",
    "outdoor temperature",
    "Outdoor_Temperature",
    "Temperature",
    "temperature",
    "Outside Air Temperature",
    "Outdoor Air Temperature",
    "OutdoorAirTemperature",
    "OAT"
  ],
  "Smoke Detector Shutdown": [
    "Smoke Detector Shutdown",
    "smoke detector shutdown",
    "Smoke_Detector_Shutdown"
  ],
  "Space Humidity": [
    "Space Humidity",
    "space humidity",
    "Space_Humidity",
    "Humidity",
    "humidity",
    "RH",
    "Relative Humidity"
  ],
  "Space RH 1": [
    "Space RH 1",
    "space rh 1",
    "Space_RH_1"
  ],
  "Space RH 2": [
    "Space RH 2",
    "space rh 2",
    "Space_RH_2"
  ],
  "Space Temperature": [
    "Space Temperature",
    "space temperature",
    "Space_Temperature",
    "Temperature",
    "temperature"
  ],
  "Space Temperature 1": [
    "Space Temperature 1",
    "space temperature 1",
    "Space_Temperature_1",
    "Temperature",
    "temperature"
  ],
  "Space Temperature 2": [
    "Space Temperature 2",
    "space temperature 2",
    "Space_Temperature_2",
    "Temperature",
    "temperature"
  ],
  "Supply Fan Amps": [
    "Supply Fan Amps",
    "supply fan amps",
    "Supply_Fan_Amps"
  ],
  "Supply Temperature": [
    "Supply Temperature",
    "supply temperature",
    "Supply_Temperature",
    "Temperature",
    "temperature",
    "Supply Air Temperature",
    "SupplyAirTemperature",
    "SAT"
  ],
  "Exhaust Fan VFD Speed": [
    "Exhaust Fan VFD Speed",
    "exhaust fan vfd speed",
    "Exhaust_Fan_VFD_Speed"
  ],
  "Heating Enabled": [
    "Heating Enabled",
    "heating enabled",
    "Heating_Enabled"
  ],
  "Space RH 3": [
    "Space RH 3",
    "space rh 3",
    "Space_RH_3"
  ],
  "Space RH 4": [
    "Space RH 4",
    "space rh 4",
    "Space_RH_4"
  ],
  "Space RH 5": [
    "Space RH 5",
    "space rh 5",
    "Space_RH_5"
  ],
  "Space Temperature 3": [
    "Space Temperature 3",
    "space temperature 3",
    "Space_Temperature_3",
    "Temperature",
    "temperature"
  ],
  "Space Temperature 4": [
    "Space Temperature 4",
    "space temperature 4",
    "Space_Temperature_4",
    "Temperature",
    "temperature"
  ],
  "Space Temperature 5": [
    "Space Temperature 5",
    "space temperature 5",
    "Space_Temperature_5",
    "Temperature",
    "temperature"
  ],
  "Element MUA1": [
    "Element MUA1",
    "element mua1",
    "Element_MUA1"
  ],
  "Freeze Trip": [
    "Freeze Trip",
    "freeze trip",
    "Freeze_Trip"
  ],
  "Intake Air": [
    "Intake Air",
    "intake air",
    "Intake_Air"
  ],
  "Lab RH": [
    "Lab RH",
    "lab rh",
    "Lab_RH"
  ],
  "Lab Temperature": [
    "Lab Temperature",
    "lab temperature",
    "Lab_Temperature",
    "Temperature",
    "temperature"
  ],
  "CW Actuator": [
    "CW Actuator",
    "cw actuator",
    "CW_Actuator"
  ],
  "Freezestat": [
    "Freezestat",
    "freezestat"
  ],
  "HW Actuator": [
    "HW Actuator",
    "hw actuator",
    "HW_Actuator"
  ],
  "Humidity": [
    "Humidity",
    "humidity",
    "RH",
    "Relative Humidity"
  ],
  "Integral": [
    "Integral",
    "integral"
  ],
  "Last Error": [
    "Last Error",
    "last error",
    "Last_Error"
  ],
  "Occupied": [
    "Occupied",
    "occupied"
  ],
  "Outdoor Air": [
    "Outdoor Air",
    "outdoor air",
    "Outdoor_Air"
  ],
  "Setpoint": [
    "Setpoint",
    "setpoint"
  ],
  "VFD": [
    "VFD",
    "vfd"
  ],
  "Boiler 1 Enable": [
    "Boiler 1 Enable",
    "boiler 1 enable",
    "Boiler_1_Enable"
  ],
  "Boiler 2 Enable": [
    "Boiler 2 Enable",
    "boiler 2 enable",
    "Boiler_2_Enable"
  ],
  "Boiler 3 Enable": [
    "Boiler 3 Enable",
    "boiler 3 enable",
    "Boiler_3_Enable"
  ],
  "Boiler 4 Enable": [
    "Boiler 4 Enable",
    "boiler 4 enable",
    "Boiler_4_Enable"
  ],
  "CW Pump 1 Enable": [
    "CW Pump 1 Enable",
    "cw pump 1 enable",
    "CW_Pump_1_Enable"
  ],
  "CW Pump 1 Status": [
    "CW Pump 1 Status",
    "cw pump 1 status",
    "CW_Pump_1_Status"
  ],
  "CW Pump 2 Enable": [
    "CW Pump 2 Enable",
    "cw pump 2 enable",
    "CW_Pump_2_Enable"
  ],
  "CW Pump 2 Status": [
    "CW Pump 2 Status",
    "cw pump 2 status",
    "CW_Pump_2_Status"
  ],
  "Chiller 1 Enable": [
    "Chiller 1 Enable",
    "chiller 1 enable",
    "Chiller_1_Enable"
  ],
  "Chiller 2 Enable": [
    "Chiller 2 Enable",
    "chiller 2 enable",
    "Chiller_2_Enable"
  ],
  "Equipment States Last Update": [
    "Equipment States Last Update",
    "equipment states last update",
    "Equipment_States_Last_Update"
  ],
  "H2O Return Temperature": [
    "H2O Return Temperature",
    "h2o return temperature",
    "H2O_Return_Temperature",
    "Temperature",
    "temperature",
    "Return Air Temperature",
    "ReturnAirTemperature",
    "Return Temperature",
    "RAT"
  ],
  "H2O Supply Temperature": [
    "H2O Supply Temperature",
    "h2o supply temperature",
    "H2O_Supply_Temperature",
    "Temperature",
    "temperature",
    "Supply Air Temperature",
    "SupplyAirTemperature",
    "Supply Temperature",
    "SAT"
  ],
  "HW Pump 1 Enable": [
    "HW Pump 1 Enable",
    "hw pump 1 enable",
    "HW_Pump_1_Enable"
  ],
  "HW Pump 2 Enable": [
    "HW Pump 2 Enable",
    "hw pump 2 enable",
    "HW_Pump_2_Enable"
  ],
  "Heating Loop Return Temperature": [
    "Heating Loop Return Temperature",
    "heating loop return temperature",
    "Heating_Loop_Return_Temperature",
    "Temperature",
    "temperature",
    "Return Air Temperature",
    "ReturnAirTemperature",
    "Return Temperature",
    "RAT"
  ],
  "Heating Loop Supply Temperature": [
    "Heating Loop Supply Temperature",
    "heating loop supply temperature",
    "Heating_Loop_Supply_Temperature",
    "Temperature",
    "temperature",
    "Supply Air Temperature",
    "SupplyAirTemperature",
    "Supply Temperature",
    "SAT"
  ],
  "Thermostat Last Update": [
    "Thermostat Last Update",
    "thermostat last update",
    "Thermostat_Last_Update"
  ],
  "Last Simulated Pressure": [
    "Last Simulated Pressure",
    "last simulated pressure",
    "Last_Simulated_Pressure",
    "Pressure",
    "pressure",
    "Static Pressure",
    "SP"
  ],
  "Active Pump": [
    "Active Pump",
    "active pump",
    "Active_Pump"
  ],
  "Ambient Temperature": [
    "Ambient Temperature",
    "ambient temperature",
    "Ambient_Temperature",
    "Temperature",
    "temperature"
  ],
  "Boiler 1 Status": [
    "Boiler 1 Status",
    "boiler 1 status",
    "Boiler_1_Status"
  ],
  "Boiler 2 Status": [
    "Boiler 2 Status",
    "boiler 2 status",
    "Boiler_2_Status"
  ],
  "DM H2O Return": [
    "DM H2O Return",
    "dm h2o return",
    "DM_H2O_Return"
  ],
  "DM H2O Supply": [
    "DM H2O Supply",
    "dm h2o supply",
    "DM_H2O_Supply"
  ],
  "DM Target Temperature": [
    "DM Target Temperature",
    "dm target temperature",
    "DM_Target_Temperature",
    "Temperature",
    "temperature"
  ],
  "DM Temperature Differential": [
    "DM Temperature Differential",
    "dm temperature differential",
    "DM_Temperature_Differential",
    "Temperature",
    "temperature"
  ],
  "Pump 1 Status": [
    "Pump 1 Status",
    "pump 1 status",
    "Pump_1_Status"
  ],
  "Pump 2 Status": [
    "Pump 2 Status",
    "pump 2 status",
    "Pump_2_Status"
  ],
  "Temperature Differential": [
    "Temperature Differential",
    "temperature differential",
    "Temperature_Differential",
    "Temperature",
    "temperature"
  ],
  "Lead Lag Week": [
    "Lead Lag Week",
    "lead lag week",
    "Lead_Lag_Week"
  ],
  "Pump Discharge Pressure": [
    "Pump Discharge Pressure",
    "pump discharge pressure",
    "Pump_Discharge_Pressure",
    "Pressure",
    "pressure",
    "Static Pressure",
    "SP"
  ],
  "VFD Status": [
    "VFD Status",
    "vfd status",
    "VFD_Status"
  ],
  "Cooling Actuator": [
    "Cooling Actuator",
    "cooling actuator",
    "Cooling_Actuator"
  ],
  "Fan Amps": [
    "Fan Amps",
    "fan amps",
    "Fan_Amps"
  ],
  "Fan Enabled": [
    "Fan Enabled",
    "fan enabled",
    "Fan_Enabled"
  ],
  "Fan Running": [
    "Fan Running",
    "fan running",
    "Fan_Running"
  ],
  "Pump Amps": [
    "Pump Amps",
    "pump amps",
    "Pump_Amps"
  ],
  "Pump Running": [
    "Pump Running",
    "pump running",
    "Pump_Running"
  ],
  "Pump Status": [
    "Pump Status",
    "pump status",
    "Pump_Status"
  ],
  "Global Setpoint": [
    "Global Setpoint",
    "global setpoint",
    "Global_Setpoint"
  ],
  "Heating Stage 1 Amps": [
    "Heating Stage 1 Amps",
    "heating stage 1 amps",
    "Heating_Stage_1_Amps"
  ],
  "Heating Stage 1 Status": [
    "Heating Stage 1 Status",
    "heating stage 1 status",
    "Heating_Stage_1_Status"
  ],
  "Heating Stage 2 Amps": [
    "Heating Stage 2 Amps",
    "heating stage 2 amps",
    "Heating_Stage_2_Amps"
  ],
  "Heating Stage 2 Status": [
    "Heating Stage 2 Status",
    "heating stage 2 status",
    "Heating_Stage_2_Status"
  ],
  "Outdoor Actuator": [
    "Outdoor Actuator",
    "outdoor actuator",
    "Outdoor_Actuator"
  ],
  "Return Actuator": [
    "Return Actuator",
    "return actuator",
    "Return_Actuator"
  ],
  "Return Temperature": [
    "Return Temperature",
    "return temperature",
    "Return_Temperature",
    "Temperature",
    "temperature",
    "Return Air Temperature",
    "ReturnAirTemperature",
    "RAT"
  ],
  "Dehumidification Active": [
    "Dehumidification Active",
    "dehumidification active",
    "Dehumidification_Active",
    "Humidity",
    "humidity",
    "RH",
    "Relative Humidity"
  ],
  "Last Preheat Error": [
    "Last Preheat Error",
    "last preheat error",
    "Last_Preheat_Error"
  ],
  "Last Pump State": [
    "Last Pump State",
    "last pump state",
    "Last_Pump_State"
  ],
  "Last Reheat Error": [
    "Last Reheat Error",
    "last reheat error",
    "Last_Reheat_Error"
  ],
  "Preheat Integral": [
    "Preheat Integral",
    "preheat integral",
    "Preheat_Integral"
  ],
  "Preheat Valve": [
    "Preheat Valve",
    "preheat valve",
    "Preheat_Valve"
  ],
  "Reheat Integral": [
    "Reheat Integral",
    "reheat integral",
    "Reheat_Integral"
  ],
  "Reheat Valve": [
    "Reheat Valve",
    "reheat valve",
    "Reheat_Valve"
  ],
  "OneThird Actuator": [
    "OneThird Actuator",
    "onethird actuator",
    "OneThird_Actuator"
  ],
  "Pump 1 Amps": [
    "Pump 1 Amps",
    "pump 1 amps",
    "Pump_1_Amps"
  ],
  "Pump 2 Amps": [
    "Pump 2 Amps",
    "pump 2 amps",
    "Pump_2_Amps"
  ],
  "Pump 2 Running": [
    "Pump 2 Running",
    "pump 2 running",
    "Pump_2_Running"
  ],
  "TwoThirds Actuator": [
    "TwoThirds Actuator",
    "twothirds actuator",
    "TwoThirds_Actuator"
  ],
  "Valve 1 Active": [
    "Valve 1 Active",
    "valve 1 active",
    "Valve_1_Active"
  ],
  "Valve 1 Percent": [
    "Valve 1 Percent",
    "valve 1 percent",
    "Valve_1_Percent"
  ],
  "Valve 2 Active": [
    "Valve 2 Active",
    "valve 2 active",
    "Valve_2_Active"
  ],
  "Valve 2 Percent": [
    "Valve 2 Percent",
    "valve 2 percent",
    "Valve_2_Percent"
  ],
  "Circuit 1 SLT": [
    "Circuit 1 SLT",
    "circuit 1 slt",
    "Circuit_1_SLT"
  ],
  "Circuit 2 SLT": [
    "Circuit 2 SLT",
    "circuit 2 slt",
    "Circuit_2_SLT"
  ],
  "Active Boiler": [
    "Active Boiler",
    "active boiler",
    "Active_Boiler"
  ],
  "Aux Pump Status": [
    "Aux Pump Status",
    "aux pump status",
    "Aux_Pump_Status"
  ],
  "Boiler 1 Enabled": [
    "Boiler 1 Enabled",
    "boiler 1 enabled",
    "Boiler_1_Enabled"
  ],
  "Boiler 2 Enabled": [
    "Boiler 2 Enabled",
    "boiler 2 enabled",
    "Boiler_2_Enabled"
  ],
  "Boiler Enable": [
    "Boiler Enable",
    "boiler enable",
    "Boiler_Enable"
  ],
  "Boiler Timer": [
    "Boiler Timer",
    "boiler timer",
    "Boiler_Timer"
  ],
  "Pump 4 Status": [
    "Pump 4 Status",
    "pump 4 status",
    "Pump_4_Status"
  ],
  "Pump Pressure": [
    "Pump Pressure",
    "pump pressure",
    "Pump_Pressure",
    "Pressure",
    "pressure",
    "Static Pressure",
    "SP"
  ],
  "Pump Pressure (alt)": [
    "Pump Pressure (alt)",
    "pump pressure (alt)",
    "Pump_Pressure_(alt)",
    "Pressure",
    "pressure",
    "Static Pressure",
    "SP"
  ],
  "Timer Started": [
    "Timer Started",
    "timer started",
    "Timer_Started"
  ],
  "VAV Pump Status": [
    "VAV Pump Status",
    "vav pump status",
    "VAV_Pump_Status"
  ],
  "Compressor Starts Counter": [
    "Compressor Starts Counter",
    "compressor starts counter",
    "Compressor_Starts_Counter",
    "Pressure",
    "pressure",
    "Static Pressure",
    "SP"
  ],
  "Mechanical Cooling Alarm Active": [
    "Mechanical Cooling Alarm Active",
    "mechanical cooling alarm active",
    "Mechanical_Cooling_Alarm_Active"
  ],
  "RPI CPU %": [
    "RPI CPU %",
    "rpi cpu %",
    "RPI_CPU_%"
  ],
  "RPI Core Temperature": [
    "RPI Core Temperature",
    "rpi core temperature",
    "RPI_Core_Temperature",
    "Temperature",
    "temperature"
  ],
  "Average Temperature": [
    "Average Temperature",
    "average temperature",
    "Average_Temperature",
    "Temperature",
    "temperature"
  ],
  "Cooling Alarm": [
    "Cooling Alarm",
    "cooling alarm",
    "Cooling_Alarm"
  ],
  "Downstairs Environment": [
    "Downstairs Environment",
    "downstairs environment",
    "Downstairs_Environment"
  ],
  "H2O Alarm": [
    "H2O Alarm",
    "h2o alarm",
    "H2O_Alarm"
  ],
  "Heating Alarm": [
    "Heating Alarm",
    "heating alarm",
    "Heating_Alarm"
  ],
  "Last Valid BME280 Reading": [
    "Last Valid BME280 Reading",
    "last valid bme280 reading",
    "Last_Valid_BME280_Reading"
  ],
  "Last Valid Thermistor Reading": [
    "Last Valid Thermistor Reading",
    "last valid thermistor reading",
    "Last_Valid_Thermistor_Reading"
  ],
  "Upstairs Environment": [
    "Upstairs Environment",
    "upstairs environment",
    "Upstairs_Environment"
  ],
  "H2O Supply Alt": [
    "H2O Supply Alt",
    "h2o supply alt",
    "H2O_Supply_Alt"
  ],
  "Supply Air": [
    "Supply Air",
    "supply air",
    "Supply_Air"
  ],
  "Cooling Modulation Logic Status": [
    "Cooling Modulation Logic Status",
    "cooling modulation logic status",
    "Cooling_Modulation_Logic_Status"
  ],
  "Cooling Setpoint Differential": [
    "Cooling Setpoint Differential",
    "cooling setpoint differential",
    "Cooling_Setpoint_Differential"
  ],
  "Heating Modulation Logic Status": [
    "Heating Modulation Logic Status",
    "heating modulation logic status",
    "Heating_Modulation_Logic_Status"
  ],
  "Heating Setpoint Differential": [
    "Heating Setpoint Differential",
    "heating setpoint differential",
    "Heating_Setpoint_Differential"
  ],
  "Last No Alarm Time": [
    "Last No Alarm Time",
    "last no alarm time",
    "Last_No_Alarm_Time"
  ],
  "Average Humidity": [
    "Average Humidity",
    "average humidity",
    "Average_Humidity",
    "Humidity",
    "humidity",
    "RH",
    "Relative Humidity"
  ],
  "Exhaust Active Control": [
    "Exhaust Active Control",
    "exhaust active control",
    "Exhaust_Active_Control"
  ],
  "Exhaust Fan 1 Active Control": [
    "Exhaust Fan 1 Active Control",
    "exhaust fan 1 active control",
    "Exhaust_Fan_1_Active_Control"
  ],
  "Exhaust Fan 1 Enabled": [
    "Exhaust Fan 1 Enabled",
    "exhaust fan 1 enabled",
    "Exhaust_Fan_1_Enabled"
  ],
  "Exhaust Fan 2 Active Control": [
    "Exhaust Fan 2 Active Control",
    "exhaust fan 2 active control",
    "Exhaust_Fan_2_Active_Control"
  ],
  "Exhaust Fan 2 Enabled": [
    "Exhaust Fan 2 Enabled",
    "exhaust fan 2 enabled",
    "Exhaust_Fan_2_Enabled"
  ],
  "FCU 1 Active Control": [
    "FCU 1 Active Control",
    "fcu 1 active control",
    "FCU_1_Active_Control"
  ],
  "FCU 1 Enabled": [
    "FCU 1 Enabled",
    "fcu 1 enabled",
    "FCU_1_Enabled"
  ],
  "FCU 2 Active Control": [
    "FCU 2 Active Control",
    "fcu 2 active control",
    "FCU_2_Active_Control"
  ],
  "FCU 2 Enabled": [
    "FCU 2 Enabled",
    "fcu 2 enabled",
    "FCU_2_Enabled"
  ],
  "FCU 3 Enabled": [
    "FCU 3 Enabled",
    "fcu 3 enabled",
    "FCU_3_Enabled"
  ],
  "FCU 4 Active Control": [
    "FCU 4 Active Control",
    "fcu 4 active control",
    "FCU_4_Active_Control"
  ],
  "FCU 4 Enabled": [
    "FCU 4 Enabled",
    "fcu 4 enabled",
    "FCU_4_Enabled"
  ],
  "FCU Active Control": [
    "FCU Active Control",
    "fcu active control",
    "FCU_Active_Control"
  ],
  "Floor Heat 2 Enabled": [
    "Floor Heat 2 Enabled",
    "floor heat 2 enabled",
    "Floor_Heat_2_Enabled"
  ],
  "Floor Heat Active Control": [
    "Floor Heat Active Control",
    "floor heat active control",
    "Floor_Heat_Active_Control"
  ],
  "Humidity 1": [
    "Humidity 1",
    "humidity 1",
    "Humidity_1",
    "Humidity",
    "humidity",
    "RH",
    "Relative Humidity"
  ],
  "Humidity 2": [
    "Humidity 2",
    "humidity 2",
    "Humidity_2",
    "Humidity",
    "humidity",
    "RH",
    "Relative Humidity"
  ],
  "Is Raining": [
    "Is Raining",
    "is raining",
    "Is_Raining"
  ],
  "Outside Temperature": [
    "Outside Temperature",
    "outside temperature",
    "Outside_Temperature",
    "Temperature",
    "temperature",
    "Outside Air Temperature",
    "Outdoor Air Temperature",
    "OutdoorAirTemperature",
    "OAT"
  ],
  "Supply Active Control": [
    "Supply Active Control",
    "supply active control",
    "Supply_Active_Control"
  ],
  "Supply Enabled": [
    "Supply Enabled",
    "supply enabled",
    "Supply_Enabled"
  ],
  "Temperature 1": [
    "Temperature 1",
    "temperature 1",
    "Temperature_1",
    "Temperature",
    "temperature"
  ],
  "Temperature 2": [
    "Temperature 2",
    "temperature 2",
    "Temperature_2",
    "Temperature",
    "temperature"
  ],
  "Time of Day": [
    "Time of Day",
    "time of day",
    "Time_of_Day"
  ],
  "Zone 1 Humidity": [
    "Zone 1 Humidity",
    "zone 1 humidity",
    "Zone_1_Humidity",
    "Humidity",
    "humidity",
    "RH",
    "Relative Humidity"
  ],
  "Zone 1 Temperature": [
    "Zone 1 Temperature",
    "zone 1 temperature",
    "Zone_1_Temperature",
    "Temperature",
    "temperature"
  ],
  "Zone 2 Humidity": [
    "Zone 2 Humidity",
    "zone 2 humidity",
    "Zone_2_Humidity",
    "Humidity",
    "humidity",
    "RH",
    "Relative Humidity"
  ],
  "Zone 2 Temperature": [
    "Zone 2 Temperature",
    "zone 2 temperature",
    "Zone_2_Temperature",
    "Temperature",
    "temperature"
  ]
};

// Metric mappings by type
const metricTypeMapping = {
  "temperature": [
    "Discharge Air",
    "Mixed Air",
    "Outdoor Air Temperature",
    "Return Air",
    "Target Temperature",
    "Mixed Air Temperature",
    "North Upstairs",
    "Thermostat Ambient Temperature",
    "Thermostat Target Temperature",
    "Boiler Loop Temperature",
    "Outdoor Temperature",
    "Space Temperature",
    "Space Temperature 1",
    "Space Temperature 2",
    "Supply Temperature",
    "Space Temperature 3",
    "Space Temperature 4",
    "Space Temperature 5",
    "Intake Air",
    "Lab Temperature",
    "Outdoor Air",
    "H2O Return Temperature",
    "H2O Supply Temperature",
    "Heating Loop Return Temperature",
    "Heating Loop Supply Temperature",
    "Ambient Temperature",
    "DM Target Temperature",
    "DM Temperature Differential",
    "Temperature Differential",
    "Return Temperature",
    "RPI Core Temperature",
    "Average Temperature",
    "Downstairs Environment",
    "Upstairs Environment",
    "Supply Air",
    "Outside Temperature",
    "Temperature 1",
    "Temperature 2",
    "Zone 1 Temperature",
    "Zone 2 Temperature"
  ],
  "humidity": [
    "Outdoor Humidity",
    "Space Humidity",
    "Space RH 1",
    "Space RH 2",
    "Space RH 3",
    "Space RH 4",
    "Space RH 5",
    "Lab RH",
    "Humidity",
    "Dehumidification Active",
    "Average Humidity",
    "Humidity 1",
    "Humidity 2",
    "Zone 1 Humidity",
    "Zone 2 Humidity"
  ],
  "pressure": [
    "Differential Pressure",
    "Building Pressure",
    "Last Simulated Pressure",
    "Pump Discharge Pressure",
    "Pump Pressure",
    "Pump Pressure (alt)",
    "Compressor Starts Counter"
  ],
  "airflow": [],
  "valve": [
    "Preheat Valve",
    "Reheat Valve",
    "Valve 1 Active",
    "Valve 1 Percent",
    "Valve 2 Active",
    "Valve 2 Percent"
  ],
  "damper": [],
  "fan": [
    "Fan Status",
    "Exhaust Fan Amps",
    "Exhaust Fan Status",
    "Supply Fan Amps",
    "Exhaust Fan VFD Speed",
    "Fan Amps",
    "Fan Enabled",
    "Fan Running",
    "Exhaust Fan 1 Active Control",
    "Exhaust Fan 1 Enabled",
    "Exhaust Fan 2 Active Control",
    "Exhaust Fan 2 Enabled"
  ],
  "pump": [
    "HW Pump 1 Status",
    "HW Pump 2 Status",
    "Last Enabled Pump",
    "CW Pump 1 Enable",
    "CW Pump 1 Status",
    "CW Pump 2 Enable",
    "CW Pump 2 Status",
    "HW Pump 1 Enable",
    "HW Pump 2 Enable",
    "Active Pump",
    "Pump 1 Status",
    "Pump 2 Status",
    "Pump Amps",
    "Pump Running",
    "Pump Status",
    "Last Pump State",
    "Pump 1 Amps",
    "Pump 2 Amps",
    "Pump 2 Running",
    "Aux Pump Status",
    "Pump 4 Status",
    "VAV Pump Status"
  ],
  "status": [
    "Active Switch State",
    "Cooling Enabled",
    "DX Enabled",
    "HVAC State",
    "Stage 1 Enabled",
    "Stage 2 Enabled",
    "VFD Enabled",
    "Thermostat Switch State",
    "Alarm Status",
    "Freeze Status",
    "Last Cooling State",
    "Last Heating State",
    "Heating Enabled",
    "Equipment States Last Update",
    "Boiler 1 Status",
    "Boiler 2 Status",
    "VFD Status",
    "Heating Stage 1 Status",
    "Heating Stage 2 Status",
    "Boiler 1 Enabled",
    "Boiler 2 Enabled",
    "Cooling Modulation Logic Status",
    "Heating Modulation Logic Status",
    "FCU 1 Enabled",
    "FCU 2 Enabled",
    "FCU 3 Enabled",
    "FCU 4 Enabled",
    "Floor Heat 2 Enabled",
    "Supply Enabled"
  ],
  "setpoint": [
    "Setpoint Differential",
    "Setpoint",
    "Global Setpoint",
    "Cooling Setpoint Differential",
    "Heating Setpoint Differential"
  ],
  "actuator": [
    "Heating Actuator",
    "Outdoor Air Actuator",
    "Return Air Actuator",
    "OA Actuator",
    "CW Actuator",
    "HW Actuator",
    "Cooling Actuator",
    "Outdoor Actuator",
    "Return Actuator",
    "OneThird Actuator",
    "TwoThirds Actuator"
  ],
  "mode": [
    "Thermostat Mode",
    "HOA Mode"
  ],
  "alarm": [
    "Mechanical Cooling Alarm Active",
    "Cooling Alarm",
    "H2O Alarm",
    "Heating Alarm",
    "Last No Alarm Time"
  ],
  "other": [
    "Cooling Differential",
    "Last Enable Time",
    "Last Stage 1 Time",
    "Last Stage 2 Time",
    "Occupancy Set For Day",
    "Outdoor Wind Speed",
    "VFD Speed",
    "DX Enable",
    "Freeze Stat",
    "Thermostat Away",
    "Heating Differential",
    "South Office",
    "Supply",
    "H2O Return",
    "H2O Supply",
    "Exhaust VFD Speed",
    "Occupied Scheduled",
    "Smoke Detector Shutdown",
    "Element MUA1",
    "Freeze Trip",
    "Freezestat",
    "Integral",
    "Last Error",
    "Occupied",
    "VFD",
    "Boiler 1 Enable",
    "Boiler 2 Enable",
    "Boiler 3 Enable",
    "Boiler 4 Enable",
    "Chiller 1 Enable",
    "Chiller 2 Enable",
    "Thermostat Last Update",
    "DM H2O Return",
    "DM H2O Supply",
    "Lead Lag Week",
    "Heating Stage 1 Amps",
    "Heating Stage 2 Amps",
    "Last Preheat Error",
    "Last Reheat Error",
    "Preheat Integral",
    "Reheat Integral",
    "Circuit 1 SLT",
    "Circuit 2 SLT",
    "Active Boiler",
    "Boiler Enable",
    "Boiler Timer",
    "Timer Started",
    "RPI CPU %",
    "Last Valid BME280 Reading",
    "Last Valid Thermistor Reading",
    "H2O Supply Alt",
    "Exhaust Active Control",
    "FCU 1 Active Control",
    "FCU 2 Active Control",
    "FCU 4 Active Control",
    "FCU Active Control",
    "Floor Heat Active Control",
    "Is Raining",
    "Supply Active Control",
    "Time of Day"
  ]
};

/**
 * Get a metric value using the mappings
 * @param {string} locationId - The location ID
 * @param {string} systemId - The system/equipment ID
 * @param {string} metricName - The metric name to look for
 * @param {Object} rtdbData - The RTDB data
 * @returns {number|null} - The metric value or null if not found
 */
function getMetricValue(locationId, systemId, metricName, rtdbData) {
  if (!rtdbData) {
    console.log("No RTDB data available");
    return null;
  }

  try {
    // First, find the location key that matches the locationId
    let locationKey = null;

    // Try direct match first
    if (rtdbData[locationId]) {
      locationKey = locationId;
    } else {
      // If not found directly, search through all locations
      console.log(`Location ${locationId} not found directly, searching through all locations`);
      
      // Try to find a location with a matching ID property
      for (const [key, value] of Object.entries(rtdbData)) {
        if (value.id === locationId) {
          locationKey = key;
          console.log(`Found location with matching ID: ${key}`);
          break;
        }
      }

      if (!locationKey) {
        console.log(`No location found for ID: ${locationId}`);
        return null;
      }
    }

    // Check if location has systems
    if (!rtdbData[locationKey].systems) {
      console.log(`No systems found for location ${locationKey}`);
      return null;
    }

    // Check if system exists
    if (!rtdbData[locationKey].systems[systemId]) {
      console.log(`System ${systemId} not found in location ${locationKey}`);

      // Try to find a system with a similar name
      const systemKeys = Object.keys(rtdbData[locationKey].systems);
      console.log(`Available systems in ${locationKey}: ${systemKeys.join(", ")}`);

      // Try case-insensitive match with more flexible matching
      const systemMatch = systemKeys.find((key) => {
        // Try exact match first (case insensitive)
        if (key.toLowerCase() === systemId.toLowerCase()) {
          return true;
        }

        // Try partial matches
        if (
          key.toLowerCase().includes(systemId.toLowerCase()) ||
          systemId.toLowerCase().includes(key.toLowerCase())
        ) {
          return true;
        }

        // Try matching by type (if systemId contains a type like "Boiler", "AHU", etc.)
        const commonTypes = ["boiler", "ahu", "chiller", "pump", "fan", "vav", "rtu", "fcu"];
        for (const type of commonTypes) {
          if (systemId.toLowerCase().includes(type) && key.toLowerCase().includes(type)) {
            return true;
          }
        }

        return false;
      });

      if (systemMatch) {
        console.log(`Found system with similar name: ${systemMatch}`);
        systemId = systemMatch;
      } else {
        return null;
      }
    }

    // Check if system has metrics
    if (!rtdbData[locationKey].systems[systemId].metrics) {
      console.log(`No metrics found for system ${systemId} in location ${locationKey}`);
      return null;
    }

    // Get the metrics object
    const metrics = rtdbData[locationKey].systems[systemId].metrics;
    
    // Try to find the metric using the mappings
    if (metricMappings[metricName]) {
      for (const mappedName of metricMappings[metricName]) {
        if (metrics[mappedName] !== undefined) {
          const value = metrics[mappedName];
          console.log(`Found mapped metric ${metricName} -> ${mappedName}: ${value}`);
          return typeof value === "number" ? value : Number.parseFloat(value);
        }
      }
    }
    
    // If no direct mapping found, try to find by type
    // Determine the likely type of the metric
    const metricType = getMetricType(metricName);
    if (metricType && metricTypeMapping[metricType]) {
      // Try each metric of this type
      for (const typedMetricName of metricTypeMapping[metricType]) {
        if (metrics[typedMetricName] !== undefined) {
          const value = metrics[typedMetricName];
          console.log(`Found metric by type (${metricType}): ${metricName} -> ${typedMetricName}: ${value}`);
          return typeof value === "number" ? value : Number.parseFloat(value);
        }
      }
    }
    
    // If still not found, try direct match
    if (metrics[metricName] !== undefined) {
      const value = metrics[metricName];
      console.log(`Found exact match for metric ${metricName}: ${value}`);
      return typeof value === "number" ? value : Number.parseFloat(value);
    }

    // Try case-insensitive match
    const metricNameLower = metricName.toLowerCase();
    for (const key of Object.keys(metrics)) {
      if (key.toLowerCase() === metricNameLower) {
        const value = metrics[key];
        console.log(`Found case-insensitive match for metric ${metricName} -> ${key}: ${value}`);
        return typeof value === "number" ? value : Number.parseFloat(value);
      }
    }

    // Try partial match (if metric name contains the search term or vice versa)
    for (const key of Object.keys(metrics)) {
      if (key.toLowerCase().includes(metricNameLower) || metricNameLower.includes(key.toLowerCase())) {
        const value = metrics[key];
        console.log(`Found partial match for metric ${metricName} -> ${key}: ${value}`);
        return typeof value === "number" ? value : Number.parseFloat(value);
      }
    }

    console.log(`Metric ${metricName} not found in system ${systemId} in location ${locationKey}`);
    return null;
  } catch (error) {
    console.error(`Error getting metric value for ${locationId}/${systemId}/${metricName}:`, error);
    return null;
  }
}

/**
 * Determine the likely type of a metric based on its name
 * @param {string} metricName - The metric name
 * @returns {string|null} - The likely metric type or null if unknown
 */
function getMetricType(metricName) {
  const nameLower = metricName.toLowerCase();
  
  if (nameLower.includes('temp') || nameLower.includes('air') && !nameLower.includes('actuator')) {
    return 'temperature';
  } else if (nameLower.includes('humid') || nameLower.includes('rh')) {
    return 'humidity';
  } else if (nameLower.includes('press') || nameLower.includes('static')) {
    return 'pressure';
  } else if (nameLower.includes('flow') || nameLower.includes('cfm')) {
    return 'airflow';
  } else if (nameLower.includes('valve')) {
    return 'valve';
  } else if (nameLower.includes('damper')) {
    return 'damper';
  } else if (nameLower.includes('fan')) {
    return 'fan';
  } else if (nameLower.includes('pump')) {
    return 'pump';
  } else if (nameLower.includes('status') || nameLower.includes('state') || nameLower.includes('enabled')) {
    return 'status';
  } else if (nameLower.includes('setpoint') || nameLower.includes('target')) {
    return 'setpoint';
  } else if (nameLower.includes('actuator')) {
    return 'actuator';
  } else if (nameLower.includes('mode')) {
    return 'mode';
  } else if (nameLower.includes('alarm')) {
    return 'alarm';
  }
  
  return null;
}

module.exports = {
  metricMappings,
  metricTypeMapping,
  getMetricValue,
  getMetricType
};
